<!DOCTYPE html>
<html lang="ko"
      layout:decorate="~{layout/default_layout.html}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <title>나만의 일기 - 일기</title>
</head>
<body>

<section layout:fragment="content">
    <ul>
        <li th:each="image : ${diary.attachmentList}">
            <img style="width: 300px; height: 300px;" th:src="@{/img/{folder}/{fileName}(folder=${image.diaryId}, fileName=${image.fileName})}">
        </li>
    </ul>
    <h2 th:text="${diary.title}"></h2>
    <p th:text="${diary.content}"></p>
    <button class="modify-btn">수정하기</button>
    <button class="remove-btn">삭제하기</button>
</section>

</body>
</html>

<script th:inline="javascript">
    const member = [[${member}]]
    const diary = [[${diary}]]
    const modifyBtn = document.querySelector('.modify-btn')
    const removeBtn = document.querySelector('.remove-btn')
    console.log(diary)

    modifyBtn.addEventListener('click', (e) => {
        e.preventDefault()
        location.href = `/diary/modify/${diary.id}`
    })
    // form 만들고 전송하는 코드
    removeBtn.addEventListener('click', (e) => {
        e.preventDefault()
        if(confirm('정말 삭제하시겠습니까?')) {
            const form = document.createElement('form')
            form.action = `/diary/remove/${diary.id}`
            form.method = 'post'
            form.innerHTML = "<input type='hidden' name='_method' value='DELETE'>"
            document.body.append(form)
            form.submit()
        }
    })
</script>